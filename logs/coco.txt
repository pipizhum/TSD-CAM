Namespace(backbone='vit_base_patch16_224', backend='nccl', base_dir='../../../coco', ignore_index=255, img_folder='./MSCOCO/coco2014', infer_set='val_part', label_folder='./MSCOCO/SegmentationClass', list_folder='datasets/coco', local_rank=0, logits_dir='work_dir_coco/2023-08-28-10-44-48-160665/logits/val_part', master_port=29501, model_path='work_dir_coco/2023-08-28-10-44-48-160665/checkpoints/model_iter_80000.pth', nproc_per_node=8, num_classes=81, pooling='gmp', scales=(1.0, 1.25, 1.5), segs_dir='work_dir_coco/2023-08-28-10-44-48-160665/segs/val_part')
100%|===========================================================| 1250/1250 [12:49<00:00,  1.62it/s]
 98%|========================================================== | 1230/1250 [12:52<00:12,  1.60it/s]{'pAcc': 0.7905121785720078, 'mAcc': 0.6268573499143779, 'miou': 0.41792356967035155, 'iou': {0: 0.7688659134402887, 1: 0.5202036547357421, 2: 0.39567690002297573, 3: 0.3817971895579544, 4: 0.6574083084411347, 5: 0.7196446208066466, 6: 0.6911131182619749, 7: 0.5319986114064317, 8: 0.44766449840294553, 9: 0.5445004526548101, 10: 0.540480502982914, 11: 0.4263499176472334, 12: 0.7077370620618756, 13: 0.6523841479670163, 14: 0.32600005172651214, 15: 0.5420923526229259, 16: 0.7031440790861536, 17: 0.5968811521847364, 18: 0.6074160022513625, 19: 0.7517833272450655, 20: 0.7246917664827359, 21: 0.7980135911059134, 22: 0.7976524692889937, 23: 0.737592034600927, 24: 0.7483453096707421, 25: 0.17540272887323943, 26: 0.6574258569945405, 27: 0.04758047357062525, 28: 0.1376089692679959, 29: 0.5907578734423903, 30: 0.45775013171813544, 31: 0.023028200302211116, 32: 0.054449163837992504, 33: 0.09328046602890955, 34: 0.4637978408565234, 35: 0.007826092659040338, 36: 0.13564559327600484, 37: 0.12403336714497915, 38: 0.07956915483108482, 39: 0.03973629531333016, 40: 0.2595139793288814, 41: 0.19159688099148603, 42: 0.32540520927583627, 43: 0.08781159273668172, 44: 0.2073698592763091, 45: 0.06086434952804874, 46: 0.15032169262693446, 47: 0.7170516852452539, 48: 0.459182101611367, 49: 0.3310036194364068, 50: 0.6633699696423373, 51: 0.5497978345947311, 52: 0.6300237843093002, 53: 0.46350900757602537, 54: 0.7328222251410847, 55: 0.6559339900742565, 56: 0.41886614502506503, 57: 0.22817939250886157, 58: 0.3851394265459145, 59: 0.18912915995939922, 60: 0.4962368382158165, 61: 0.20736300750936199, 62: 0.7002284016098403, 63: 0.4631499736800132, 64: 0.45040750307570715, 65: 0.14066467302375443, 66: 0.219877544266093, 67: 0.5065093075061156, 68: 0.3639412301254946, 69: 0.5539609129284556, 70: 0.26837946667417567, 71: 0.0, 72: 0.2596967529414272, 73: 0.4624897945436956, 74: 0.395276228767166, 75: 0.4359351165595871, 76: 0.40053013404302273, 77: 0.48771550921616086, 78: 0.6579619188133518, 79: 0.0, 80: 0.2672636815920398}}
100%|===========================================================| 1250/1250 [12:59<00:00,  1.60it/s]
100%|==========================================================>| 1248/1250 [13:02<00:01,  1.66it/s]{'pAcc': 0.7895640760949023, 'mAcc': 0.6169923979879284, 'miou': 0.4270655018810876, 'iou': {0: 0.768588884555089, 1: 0.5216410018740775, 2: 0.5018256352380794, 3: 0.39067652729206953, 4: 0.5725029447477953, 5: 0.8157641972940674, 6: 0.6529646805934081, 7: 0.4687729583866479, 8: 0.5010881940935287, 9: 0.5369882715433297, 10: 0.464487562219273, 11: 0.7535458274462259, 12: 0.6918507430482509, 13: 0.5746549847959401, 14: 0.4172812511581366, 15: 0.5403903820642646, 16: 0.715720200780937, 17: 0.6968792068461779, 18: 0.6986543873373225, 19: 0.6777781345875471, 20: 0.6020766246210396, 21: 0.7974981076028185, 22: 0.8482370831975885, 23: 0.8173343893984294, 24: 0.7134318572705187, 25: 0.25680532549926555, 26: 0.6668507969755798, 27: 0.04058775396145308, 28: 0.12846329947059665, 29: 0.487746691372016, 30: 0.32196266936526674, 31: 0.018752561790119568, 32: 0.053504828124395824, 33: 0.1899516248820731, 34: 0.3667602426431614, 35: 0.004708372452684194, 36: 0.28680157593123207, 37: 0.1317648249433676, 38: 0.14468667145772263, 39: 0.0274187989566785, 40: 0.2785171200314127, 41: 0.18617410628911324, 42: 0.2758597026660495, 43: 0.04062658936018716, 44: 0.10413347110497362, 45: 0.008761688122150313, 46: 0.15243952444068143, 47: 0.740022681046941, 48: 0.6467642662137598, 49: 0.5498388387880415, 50: 0.6848628166044617, 51: 0.4302732761874627, 52: 0.34594769297653505, 53: 0.7291453184010542, 54: 0.6083288428324698, 55: 0.7961214370455997, 56: 0.4500737616839924, 57: 0.22607996740597913, 58: 0.37618955868030735, 59: 0.23053443564738432, 60: 0.4992567461259922, 61: 0.25704603490818984, 62: 0.5431944949542569, 63: 0.5073717527694896, 64: 0.5762733373070046, 65: 0.04931532166704885, 66: 0.5071694737864683, 67: 0.4440675243828819, 68: 0.6823795934428234, 69: 0.409362534732553, 70: 0.3863878968508324, 71: 0.0, 72: 0.27779689550251657, 73: 0.6360563327263402, 74: 0.2417989634492608, 75: 0.5737056250297707, 76: 0.2938271435207053, 77: 0.060805860805860805, 78: 0.7339467654159335, 79: 0.0, 80: 0.18444818364344298}}
crf post-processing...
[Parallel(n_jobs=76)]: Using backend LokyBackend with 76 concurrent workers.
100%|===========================================================| 1250/1250 [13:04<00:00,  1.59it/s]
100%|===========================================================| 1250/1250 [13:04<00:00,  1.59it/s]
{'pAcc': 0.7923724590099565, 'mAcc': 0.6205554096477772, 'miou': 0.42436929112269545, 'iou': {0: 0.7740973497704037, 1: 0.5484153306904505, 2: 0.5089287466180642, 3: 0.3823467682434632, 4: 0.6026371209085406, 5: 0.7869542247383255, 6: 0.6559183719502666, 7: 0.4886495842262398, 8: 0.3732675657844054, 9: 0.3612531121234195, 10: 0.40707225487821713, 11: 0.7560558591998547, 12: 0.6215423795383418, 13: 0.7136215439032293, 14: 0.4274991660642642, 15: 0.7026083250424567, 16: 0.6630218140959813, 17: 0.670479332150194, 18: 0.720142064698021, 19: 0.8087336201790583, 20: 0.708249579461623, 21: 0.8302849000636735, 22: 0.8212733179551468, 23: 0.8118818859131836, 24: 0.6976274004414034, 25: 0.156346144568751, 26: 0.6169553874266379, 27: 0.16727500294884734, 28: 0.12268626860402933, 29: 0.5743993666850535, 30: 0.23954208246617026, 31: 0.007213850203742466, 32: 0.10925845937222599, 33: 0.05572443994909386, 34: 0.48618478525176295, 35: 0.00940832747581951, 36: 0.04158572594117876, 37: 0.06641704681137679, 38: 0.07164098606212949, 39: 0.030145795006002816, 40: 0.19207525994032298, 41: 0.2708106531482493, 42: 0.3333135105377981, 43: 0.11202951983324674, 44: 0.085989749718462, 45: 0.02279418721789028, 46: 0.16222372795158974, 47: 0.6883724476108897, 48: 0.4519866318511232, 49: 0.38600644951727425, 50: 0.6050741550253728, 51: 0.7235341613216363, 52: 0.5507418870782662, 53: 0.6136341693465135, 54: 0.486948460457897, 55: 0.4784985706801822, 56: 0.5053136900864735, 57: 0.22710375485367607, 58: 0.4706161514857157, 59: 0.27477105281277975, 60: 0.5075176688146187, 61: 0.2036807017778707, 62: 0.6063162182817166, 63: 0.4991688511144478, 64: 0.685346358732094, 65: 0.13380182743434715, 66: 0.5846952342115613, 67: 0.3325106842677406, 68: 0.4245717833534203, 69: 0.4586867696205178, 70: 0.2697888371128422, 71: 0.0, 72: 0.25041993565975096, 73: 0.4757484576120601, 74: 0.36627431002889743, 75: 0.5325211596190175, 76: 0.3444887260104414, 77: 0.5289855072463768, 78: 0.6572145298519649, 79: 0.0, 80: 0.272991542302238}}
/root/autodl-tmp/TokeContrast/./utils/evaluate.py:22: RuntimeWarning: invalid value encountered in true_divide
  _acc_cls = np.diag(hist) / hist.sum(axis=1)
/root/autodl-tmp/TokeContrast/./utils/evaluate.py:24: RuntimeWarning: invalid value encountered in true_divide
  iu = np.diag(hist) / (hist.sum(axis=1) + hist.sum(axis=0) - np.diag(hist))
{'pAcc': 0.7866998098916872, 'mAcc': 0.6308359436914306, 'miou': 0.42555038836308273, 'iou': {0: 0.767481059245039, 1: 0.5197245501629941, 2: 0.35929480187711493, 3: 0.4525866259075277, 4: 0.6293861674017465, 5: 0.7077861241825186, 6: 0.6708778601885045, 7: 0.49823656139171524, 8: 0.4881558401546078, 9: 0.4819470754169852, 10: 0.3237443870532354, 11: 0.7377334264500187, 12: 0.5709783013822943, 13: 0.6299423590480826, 14: 0.4116222859427907, 15: 0.5618377092147414, 16: 0.6823407236948857, 17: 0.5860931698237302, 18: 0.723405316764109, 19: 0.7854831168673455, 20: 0.6534947164760907, 21: 0.8421625837742567, 22: 0.7127552550960113, 23: 0.7643903735521318, 24: 0.7267130774549858, 25: 0.13455382821980374, 26: 0.6512740583047313, 27: 0.030410946139032117, 28: 0.10745422342136478, 29: 0.5417003933723367, 30: 0.5703519862404007, 31: 0.028969535624355284, 32: 0.16924336671438772, 33: 0.0924343663720573, 34: 0.5324671498438512, 35: 0.005338908208963681, 36: 0.08122079624500497, 37: 0.1432063360758947, 38: 0.06383372412676151, 39: 0.043309137801373465, 40: 0.17890839753309823, 41: 0.22377972358509532, 42: 0.24711031929351088, 43: 0.00813285985101327, 44: 0.15623944010339555, 45: 0.03575340085956206, 46: 0.1867943665010799, 47: 0.6988698286665821, 48: 0.45413430234914287, 49: 0.4565308093230462, 50: 0.7404133863986289, 51: 0.46313960099487517, 52: 0.5027806123989349, 53: 0.5619147725402223, 54: 0.525130119102549, 55: 0.46025428352960285, 56: 0.3127520183772693, 57: 0.25635532198288574, 58: 0.3908123155698319, 59: 0.16985745424034876, 60: 0.5257598829950312, 61: 0.24091485506792543, 62: 0.5456022833963392, 63: 0.5233006247957779, 64: 0.5732202668064302, 65: 0.13883255885856666, 66: 0.743601087625225, 67: 0.5433180525735507, 68: 0.5517801940091674, 69: 0.5059810617489386, 70: 0.32126607319485656, 71: nan, 72: 0.17376512805412453, 73: 0.48714049358588574, 74: 0.24274280989201147, 75: 0.4383653917038035, 76: 0.4147204317193824, 77: 0.5240499808786457, 78: 0.6165670482298274, 79: 0.0, 80: 0.4194972854766669}}




Namespace(backbone='vit_base_patch16_224', backend='nccl', base_dir='../../../coco', ignore_index=255, img_folder='./MSCOCO/coco2014', infer_set='val_part', label_folder='./MSCOCO/SegmentationClass', list_folder='datasets/coco', local_rank=0, logits_dir='work_dir_coco/2023-08-28-10-44-48-160665/logitst/val_part', master_port=29501, model_path='work_dir_coco/2023-08-28-10-44-48-160665/checkpoints/model_iter_80000.pth', nproc_per_node=8, num_classes=81, pooling='gmp', scales=(1.0, 1.25, 1.5), segs_dir='work_dir_coco/2023-08-28-10-44-48-160665/segst/val_part')
100%|===========================================================| 1250/1250 [12:36<00:00,  1.65it/s]
 98%|=========================================================> | 1225/1250 [12:39<00:15,  1.59it/s]{'pAcc': 0.7895640760949023, 'mAcc': 0.6169923979879284, 'miou': 0.4270655018810876, 'iou': {0: 0.768588884555089, 1: 0.5216410018740775, 2: 0.5018256352380794, 3: 0.39067652729206953, 4: 0.5725029447477953, 5: 0.8157641972940674, 6: 0.6529646805934081, 7: 0.4687729583866479, 8: 0.5010881940935287, 9: 0.5369882715433297, 10: 0.464487562219273, 11: 0.7535458274462259, 12: 0.6918507430482509, 13: 0.5746549847959401, 14: 0.4172812511581366, 15: 0.5403903820642646, 16: 0.715720200780937, 17: 0.6968792068461779, 18: 0.6986543873373225, 19: 0.6777781345875471, 20: 0.6020766246210396, 21: 0.7974981076028185, 22: 0.8482370831975885, 23: 0.8173343893984294, 24: 0.7134318572705187, 25: 0.25680532549926555, 26: 0.6668507969755798, 27: 0.04058775396145308, 28: 0.12846329947059665, 29: 0.487746691372016, 30: 0.32196266936526674, 31: 0.018752561790119568, 32: 0.053504828124395824, 33: 0.1899516248820731, 34: 0.3667602426431614, 35: 0.004708372452684194, 36: 0.28680157593123207, 37: 0.1317648249433676, 38: 0.14468667145772263, 39: 0.0274187989566785, 40: 0.2785171200314127, 41: 0.18617410628911324, 42: 0.2758597026660495, 43: 0.04062658936018716, 44: 0.10413347110497362, 45: 0.008761688122150313, 46: 0.15243952444068143, 47: 0.740022681046941, 48: 0.6467642662137598, 49: 0.5498388387880415, 50: 0.6848628166044617, 51: 0.4302732761874627, 52: 0.34594769297653505, 53: 0.7291453184010542, 54: 0.6083288428324698, 55: 0.7961214370455997, 56: 0.4500737616839924, 57: 0.22607996740597913, 58: 0.37618955868030735, 59: 0.23053443564738432, 60: 0.4992567461259922, 61: 0.25704603490818984, 62: 0.5431944949542569, 63: 0.5073717527694896, 64: 0.5762733373070046, 65: 0.04931532166704885, 66: 0.5071694737864683, 67: 0.4440675243828819, 68: 0.6823795934428234, 69: 0.409362534732553, 70: 0.3863878968508324, 71: 0.0, 72: 0.27779689550251657, 73: 0.6360563327263402, 74: 0.2417989634492608, 75: 0.5737056250297707, 76: 0.2938271435207053, 77: 0.060805860805860805, 78: 0.7339467654159335, 79: 0.0, 80: 0.18444818364344298}}
 98%|=========================================================> | 1222/1250 [12:40<00:17,  1.63it/s]crf post-processing...
[Parallel(n_jobs=76)]: Using backend LokyBackend with 76 concurrent workers.
100%|===========================================================| 1250/1250 [13:10<00:00,  1.58it/s]
100%|===========================================================| 1250/1250 [13:17<00:00,  1.57it/s]
100%|===========================================================| 1250/1250 [13:18<00:00,  1.57it/s]
{'pAcc': 0.7905121785720078, 'mAcc': 0.6268573499143779, 'miou': 0.41792356967035155, 'iou': {0: 0.7688659134402887, 1: 0.5202036547357421, 2: 0.39567690002297573, 3: 0.3817971895579544, 4: 0.6574083084411347, 5: 0.7196446208066466, 6: 0.6911131182619749, 7: 0.5319986114064317, 8: 0.44766449840294553, 9: 0.5445004526548101, 10: 0.540480502982914, 11: 0.4263499176472334, 12: 0.7077370620618756, 13: 0.6523841479670163, 14: 0.32600005172651214, 15: 0.5420923526229259, 16: 0.7031440790861536, 17: 0.5968811521847364, 18: 0.6074160022513625, 19: 0.7517833272450655, 20: 0.7246917664827359, 21: 0.7980135911059134, 22: 0.7976524692889937, 23: 0.737592034600927, 24: 0.7483453096707421, 25: 0.17540272887323943, 26: 0.6574258569945405, 27: 0.04758047357062525, 28: 0.1376089692679959, 29: 0.5907578734423903, 30: 0.45775013171813544, 31: 0.023028200302211116, 32: 0.054449163837992504, 33: 0.09328046602890955, 34: 0.4637978408565234, 35: 0.007826092659040338, 36: 0.13564559327600484, 37: 0.12403336714497915, 38: 0.07956915483108482, 39: 0.03973629531333016, 40: 0.2595139793288814, 41: 0.19159688099148603, 42: 0.32540520927583627, 43: 0.08781159273668172, 44: 0.2073698592763091, 45: 0.06086434952804874, 46: 0.15032169262693446, 47: 0.7170516852452539, 48: 0.459182101611367, 49: 0.3310036194364068, 50: 0.6633699696423373, 51: 0.5497978345947311, 52: 0.6300237843093002, 53: 0.46350900757602537, 54: 0.7328222251410847, 55: 0.6559339900742565, 56: 0.41886614502506503, 57: 0.22817939250886157, 58: 0.3851394265459145, 59: 0.18912915995939922, 60: 0.4962368382158165, 61: 0.20736300750936199, 62: 0.7002284016098403, 63: 0.4631499736800132, 64: 0.45040750307570715, 65: 0.14066467302375443, 66: 0.219877544266093, 67: 0.5065093075061156, 68: 0.3639412301254946, 69: 0.5539609129284556, 70: 0.26837946667417567, 71: 0.0, 72: 0.2596967529414272, 73: 0.4624897945436956, 74: 0.395276228767166, 75: 0.4359351165595871, 76: 0.40053013404302273, 77: 0.48771550921616086, 78: 0.6579619188133518, 79: 0.0, 80: 0.2672636815920398}}
{'pAcc': 0.7923724590099565, 'mAcc': 0.6205554096477772, 'miou': 0.42436929112269545, 'iou': {0: 0.7740973497704037, 1: 0.5484153306904505, 2: 0.5089287466180642, 3: 0.3823467682434632, 4: 0.6026371209085406, 5: 0.7869542247383255, 6: 0.6559183719502666, 7: 0.4886495842262398, 8: 0.3732675657844054, 9: 0.3612531121234195, 10: 0.40707225487821713, 11: 0.7560558591998547, 12: 0.6215423795383418, 13: 0.7136215439032293, 14: 0.4274991660642642, 15: 0.7026083250424567, 16: 0.6630218140959813, 17: 0.670479332150194, 18: 0.720142064698021, 19: 0.8087336201790583, 20: 0.708249579461623, 21: 0.8302849000636735, 22: 0.8212733179551468, 23: 0.8118818859131836, 24: 0.6976274004414034, 25: 0.156346144568751, 26: 0.6169553874266379, 27: 0.16727500294884734, 28: 0.12268626860402933, 29: 0.5743993666850535, 30: 0.23954208246617026, 31: 0.007213850203742466, 32: 0.10925845937222599, 33: 0.05572443994909386, 34: 0.48618478525176295, 35: 0.00940832747581951, 36: 0.04158572594117876, 37: 0.06641704681137679, 38: 0.07164098606212949, 39: 0.030145795006002816, 40: 0.19207525994032298, 41: 0.2708106531482493, 42: 0.3333135105377981, 43: 0.11202951983324674, 44: 0.085989749718462, 45: 0.02279418721789028, 46: 0.16222372795158974, 47: 0.6883724476108897, 48: 0.4519866318511232, 49: 0.38600644951727425, 50: 0.6050741550253728, 51: 0.7235341613216363, 52: 0.5507418870782662, 53: 0.6136341693465135, 54: 0.486948460457897, 55: 0.4784985706801822, 56: 0.5053136900864735, 57: 0.22710375485367607, 58: 0.4706161514857157, 59: 0.27477105281277975, 60: 0.5075176688146187, 61: 0.2036807017778707, 62: 0.6063162182817166, 63: 0.4991688511144478, 64: 0.685346358732094, 65: 0.13380182743434715, 66: 0.5846952342115613, 67: 0.3325106842677406, 68: 0.4245717833534203, 69: 0.4586867696205178, 70: 0.2697888371128422, 71: 0.0, 72: 0.25041993565975096, 73: 0.4757484576120601, 74: 0.36627431002889743, 75: 0.5325211596190175, 76: 0.3444887260104414, 77: 0.5289855072463768, 78: 0.6572145298519649, 79: 0.0, 80: 0.272991542302238}}
/root/autodl-tmp/TokeContrast/./utils/evaluate.py:22: RuntimeWarning: invalid value encountered in true_divide
  _acc_cls = np.diag(hist) / hist.sum(axis=1)
/root/autodl-tmp/TokeContrast/./utils/evaluate.py:24: RuntimeWarning: invalid value encountered in true_divide
  iu = np.diag(hist) / (hist.sum(axis=1) + hist.sum(axis=0) - np.diag(hist))
{'pAcc': 0.7866998098916872, 'mAcc': 0.6308359436914306, 'miou': 0.42555038836308273, 'iou': {0: 0.767481059245039, 1: 0.5197245501629941, 2: 0.35929480187711493, 3: 0.4525866259075277, 4: 0.6293861674017465, 5: 0.7077861241825186, 6: 0.6708778601885045, 7: 0.49823656139171524, 8: 0.4881558401546078, 9: 0.4819470754169852, 10: 0.3237443870532354, 11: 0.7377334264500187, 12: 0.5709783013822943, 13: 0.6299423590480826, 14: 0.4116222859427907, 15: 0.5618377092147414, 16: 0.6823407236948857, 17: 0.5860931698237302, 18: 0.723405316764109, 19: 0.7854831168673455, 20: 0.6534947164760907, 21: 0.8421625837742567, 22: 0.7127552550960113, 23: 0.7643903735521318, 24: 0.7267130774549858, 25: 0.13455382821980374, 26: 0.6512740583047313, 27: 0.030410946139032117, 28: 0.10745422342136478, 29: 0.5417003933723367, 30: 0.5703519862404007, 31: 0.028969535624355284, 32: 0.16924336671438772, 33: 0.0924343663720573, 34: 0.5324671498438512, 35: 0.005338908208963681, 36: 0.08122079624500497, 37: 0.1432063360758947, 38: 0.06383372412676151, 39: 0.043309137801373465, 40: 0.17890839753309823, 41: 0.22377972358509532, 42: 0.24711031929351088, 43: 0.00813285985101327, 44: 0.15623944010339555, 45: 0.03575340085956206, 46: 0.1867943665010799, 47: 0.6988698286665821, 48: 0.45413430234914287, 49: 0.4565308093230462, 50: 0.7404133863986289, 51: 0.46313960099487517, 52: 0.5027806123989349, 53: 0.5619147725402223, 54: 0.525130119102549, 55: 0.46025428352960285, 56: 0.3127520183772693, 57: 0.25635532198288574, 58: 0.3908123155698319, 59: 0.16985745424034876, 60: 0.5257598829950312, 61: 0.24091485506792543, 62: 0.5456022833963392, 63: 0.5233006247957779, 64: 0.5732202668064302, 65: 0.13883255885856666, 66: 0.743601087625225, 67: 0.5433180525735507, 68: 0.5517801940091674, 69: 0.5059810617489386, 70: 0.32126607319485656, 71: nan, 72: 0.17376512805412453, 73: 0.48714049358588574, 74: 0.24274280989201147, 75: 0.4383653917038035, 76: 0.4147204317193824, 77: 0.5240499808786457, 78: 0.6165670482298274, 79: 0.0, 80: 0.4194972854766669}}
[Parallel(n_jobs=76)]: Done 492 out of 5000 | elapsed:  4.8min remaining: 44.0min
[Parallel(n_jobs=76)]: Done 993 out of 5000 | elapsed:  9.7min remaining: 39.2min
[Parallel(n_jobs=76)]: Done 1494 out of 5000 | elapsed: 15.0min remaining: 35.1min
[Parallel(n_jobs=76)]: Done 1995 out of 5000 | elapsed: 20.0min remaining: 30.1min
[Parallel(n_jobs=76)]: Done 2496 out of 5000 | elapsed: 24.8min remaining: 24.9min
[Parallel(n_jobs=76)]: Done 2997 out of 5000 | elapsed: 29.6min remaining: 19.8min
[Parallel(n_jobs=76)]: Done 3498 out of 5000 | elapsed: 34.3min remaining: 14.7min
[Parallel(n_jobs=76)]: Done 3999 out of 5000 | elapsed: 39.0min remaining:  9.8min
[Parallel(n_jobs=76)]: Done 4500 out of 5000 | elapsed: 43.7min remaining:  4.9min
[Parallel(n_jobs=76)]: Done 5000 out of 5000 | elapsed: 48.0min finished
{'pAcc': 0.7913627157803534, 'mAcc': 0.6181070172863099, 'miou': 0.42849545580928605, 'iou': {0: 0.771178215741182, 1: 0.5273766169927294, 2: 0.42761431418198753, 3: 0.39537406403428865, 4: 0.6184621568434651, 5: 0.763976320857683, 6: 0.6679232677472101, 7: 0.4985934210457198, 8: 0.45896309540470526, 9: 0.4879901489240024, 10: 0.449433999690147, 11: 0.6928853701938764, 12: 0.6640841925108, 13: 0.6603083413574303, 14: 0.39688537712995503, 15: 0.5993530655823125, 16: 0.6922068958559465, 17: 0.6450973836760154, 18: 0.6958230475614093, 19: 0.7609730444496797, 20: 0.6693684314289456, 21: 0.8227322687473173, 22: 0.8052862671344353, 23: 0.7868301985698313, 24: 0.7234972112491972, 25: 0.17898016305682682, 26: 0.6447481154440495, 27: 0.0750492762947261, 28: 0.12304689122869568, 29: 0.5525906501393444, 30: 0.3976272165228616, 31: 0.019637759101164484, 32: 0.09401820897849317, 33: 0.1091022800507949, 34: 0.47073656828026395, 35: 0.006654417027143085, 36: 0.15518821563473464, 37: 0.11351972306331314, 38: 0.0907749469227999, 39: 0.03372675344792685, 40: 0.23311185770875262, 41: 0.20974133453111365, 42: 0.3031180097136142, 43: 0.07808700261369345, 44: 0.14726266599486634, 45: 0.034970863220085094, 46: 0.16485926466023493, 47: 0.7162132116889652, 48: 0.4906410937428127, 49: 0.4399386276292135, 50: 0.6819891479494302, 51: 0.5301562857875666, 52: 0.5241525685937448, 53: 0.6267776508163772, 54: 0.6053620029186657, 55: 0.6325379515655993, 56: 0.41501896947910916, 57: 0.23313312569059857, 58: 0.40701523097295056, 59: 0.21212064628577013, 60: 0.5065882661301664, 61: 0.22875631309676034, 62: 0.609512518439785, 63: 0.49523669135325543, 64: 0.5605377069007564, 65: 0.10986278689013437, 66: 0.5670906297644833, 67: 0.4578545759849023, 68: 0.533105521974212, 69: 0.4805565546948336, 70: 0.3102070778680039, 71: 0.0, 72: 0.24164197562903592, 73: 0.5284030438844732, 74: 0.3123093507352058, 75: 0.5080758905385235, 76: 0.37073399502208726, 77: 0.4880167736961366, 78: 0.6646219439611121, 79: 0.0, 80: 0.30119489032172136}}




Namespace(backbone='vit_base_patch16_224', backend='nccl', base_dir='../../../coco', ignore_index=255, img_folder='./MSCOCO/coco2014', infer_set='val_part', label_folder='./MSCOCO/SegmentationClass', list_folder='datasets/coco', local_rank=0, logits_dir='work_dir_coco/2023-08-28-10-44-48-160665/logits/val_part', master_port=29501, model_path='work_dir_coco/2023-08-28-10-44-48-160665/checkpoints/model_iter_80000.pth', nproc_per_node=8, num_classes=81, pooling='gmp', scales=(1.0, 1.25, 1.5), segs_dir='work_dir_coco/2023-08-28-10-44-48-160665/segs/val_part')
100%|===========================================================| 1250/1250 [10:09<00:00,  2.05it/s]
100%|===========================================================| 1250/1250 [10:09<00:00,  2.05it/s]
 98%|========================================================== | 1231/1250 [10:12<00:10,  1.77it/s]{'pAcc': 0.7912701200207237, 'mAcc': 0.6182574586806334, 'miou': 0.42284541831791983, 'iou': {0: 0.7730945940548727, 1: 0.5456698142413555, 2: 0.5104155780820009, 3: 0.37854013420770766, 4: 0.6109771698484551, 5: 0.7849848875077159, 6: 0.6649579169053031, 7: 0.4904334869149204, 8: 0.36360024296933374, 9: 0.35511074285452093, 10: 0.39775571020541706, 11: 0.7500915090994361, 12: 0.6611286289566132, 13: 0.7031681276224503, 14: 0.43321735461358657, 15: 0.7025752454109718, 16: 0.668295041595147, 17: 0.6464420028376394, 18: 0.7198452741338716, 19: 0.8085467569424002, 20: 0.7009010115723171, 21: 0.8238131741097711, 22: 0.8297718128032504, 23: 0.8135340397515158, 24: 0.6958373279077246, 25: 0.17731756000794105, 26: 0.6358002451483199, 27: 0.1632560625118122, 28: 0.12371291295503963, 29: 0.5729793534869455, 30: 0.18133000362079615, 31: 0.007138468949823109, 32: 0.10346382940608186, 33: 0.05447297267347798, 34: 0.49667496784433923, 35: 0.009128009939301506, 36: 0.041336156711082664, 37: 0.06773247290133952, 38: 0.06720245408482571, 39: 0.029630710272426614, 40: 0.18582158714473096, 41: 0.27094034362445313, 42: 0.33758880378896167, 43: 0.10739307358229944, 44: 0.0844247485938299, 45: 0.02274485895842615, 46: 0.15354451429072463, 47: 0.6846815320238955, 48: 0.4511702591478004, 49: 0.3909191679996817, 50: 0.6242435932424585, 51: 0.7236993029351146, 52: 0.5522409007713613, 53: 0.614459633141632, 54: 0.4822369036331967, 55: 0.4775234758845248, 56: 0.5108493605447025, 57: 0.22550106109147444, 58: 0.47387453644651945, 59: 0.23758847255184853, 60: 0.5089425190453339, 61: 0.20445960220995538, 62: 0.6038122091114502, 63: 0.4848601095145214, 64: 0.6760131099252992, 65: 0.1281338493588981, 66: 0.5707529675781019, 67: 0.28571714440718965, 68: 0.48325213904665265, 69: 0.45165512633624877, 70: 0.2701764940434135, 71: 0.0, 72: 0.2522973498460809, 73: 0.4749556818360552, 74: 0.3729974703551286, 75: 0.5309015542321525, 76: 0.32607850295219354, 77: 0.5200566304860783, 78: 0.6576469729488407, 79: 0.0, 80: 0.2724395554584234}}
 99%|========================================================== | 1234/1250 [10:12<00:08,  1.94it/s]{'pAcc': 0.7892753877080828, 'mAcc': 0.6170474022756177, 'miou': 0.42667842717351473, 'iou': {0: 0.7684962631289876, 1: 0.5199006242480314, 2: 0.5081623922376124, 3: 0.3865422495157505, 4: 0.5796337084003237, 5: 0.8092874240471368, 6: 0.6585174239101848, 7: 0.4659478392651414, 8: 0.4996434375198705, 9: 0.5369272793393562, 10: 0.46890705735346944, 11: 0.7528229629142927, 12: 0.694169461483266, 13: 0.5651287713670462, 14: 0.4104723269269707, 15: 0.5377771753396245, 16: 0.710183533750469, 17: 0.6647225639743505, 18: 0.6893124235144813, 19: 0.66419040281104, 20: 0.6070727691376522, 21: 0.7967782145531278, 22: 0.8538917588010011, 23: 0.8132187651679266, 24: 0.704635084838205, 25: 0.25244935849684447, 26: 0.6418912792679, 27: 0.04156202599950574, 28: 0.12478845819572397, 29: 0.4967766364650724, 30: 0.32495114226976235, 31: 0.019521523212488703, 32: 0.04924066133924829, 33: 0.19570073607499908, 34: 0.36517704382928734, 35: 0.0045765108909817795, 36: 0.2690910800550077, 37: 0.12492695998222157, 38: 0.14351940483665937, 39: 0.026958878517971907, 40: 0.2803053656590567, 41: 0.17694970607446114, 42: 0.2863503696787113, 43: 0.048523522027616714, 44: 0.10784820121399549, 45: 0.00799631428162913, 46: 0.15617399819548072, 47: 0.7443646342838202, 48: 0.6652272497508701, 49: 0.5585979670408283, 50: 0.6815835057312043, 51: 0.4184192670902487, 52: 0.3404871177482757, 53: 0.7426859882033058, 54: 0.6136720982827036, 55: 0.8020817169630712, 56: 0.45258320765151366, 57: 0.2252365535574994, 58: 0.3767651819377183, 59: 0.22557322309833175, 60: 0.499912529687241, 61: 0.2607764664822542, 62: 0.5445248998067568, 63: 0.5035391079508726, 64: 0.58996676981799, 65: 0.04801252196177401, 66: 0.4930032539317608, 67: 0.44222661746727576, 68: 0.6823977599425786, 69: 0.39789598414768934, 70: 0.3841802408429315, 71: 0.0, 72: 0.2757796440751699, 73: 0.6334941860711676, 74: 0.2552554688166712, 75: 0.5658308352594577, 76: 0.2933028197729432, 77: 0.09779237365444261, 78: 0.7308575431993332, 79: 0.0, 80: 0.2033047767170489}}
crf post-processing...
 99%|========================================================== | 1233/1250 [10:13<00:08,  1.91it/s][Parallel(n_jobs=76)]: Using backend LokyBackend with 76 concurrent workers.
100%|===========================================================| 1250/1250 [10:21<00:00,  2.01it/s]
100%|===========================================================| 1250/1250 [10:22<00:00,  2.01it/s]
{'pAcc': 0.7903902150515295, 'mAcc': 0.625750987661035, 'miou': 0.4170999514846306, 'iou': {0: 0.7688449269585304, 1: 0.5169242991286369, 2: 0.3967284115404078, 3: 0.3773510061416568, 4: 0.6516448289673669, 5: 0.715088952455896, 6: 0.6927715396242712, 7: 0.5269547601416551, 8: 0.4544136046615664, 9: 0.5418360808315734, 10: 0.5411480566164907, 11: 0.35575019059528634, 12: 0.7220421270508021, 13: 0.6265215770765721, 14: 0.33618386078563295, 15: 0.5511920121857586, 16: 0.7164637544468473, 17: 0.5954617021198143, 18: 0.6193452516500877, 19: 0.7530313170152072, 20: 0.7236500530123633, 21: 0.801309331260055, 22: 0.7917882788973825, 23: 0.7341067237392717, 24: 0.744634473507713, 25: 0.1854370542378504, 26: 0.6603787593984962, 27: 0.04825308645731288, 28: 0.13336340249543735, 29: 0.587614840622991, 30: 0.44155367977827104, 31: 0.023481734960174267, 32: 0.05271612405547082, 33: 0.08199021012416428, 34: 0.4417438946202716, 35: 0.007800705702586568, 36: 0.12682609079667903, 37: 0.12594136857382301, 38: 0.07955438393555987, 39: 0.040124826395610526, 40: 0.25778471888515136, 41: 0.18854155609807877, 42: 0.3334020532141081, 43: 0.09158644846076966, 44: 0.1931143067500678, 45: 0.06274369290321125, 46: 0.14492517289175827, 47: 0.7149677566081237, 48: 0.4477492095190547, 49: 0.32693025053919506, 50: 0.6564038259365881, 51: 0.5460367626378143, 52: 0.6194303913762479, 53: 0.4732230783315271, 54: 0.7385784977911404, 55: 0.669696313596865, 56: 0.42199280175199255, 57: 0.21743708602404285, 58: 0.38760660944562214, 59: 0.19169033644227548, 60: 0.5067243046912245, 61: 0.21018072133149598, 62: 0.7040735685764158, 63: 0.4541213582183297, 64: 0.45933640457476455, 65: 0.1348255881722573, 66: 0.29155734279627055, 67: 0.4837038473310333, 68: 0.3503524966755553, 69: 0.5759575518904095, 70: 0.2687545762041874, 71: 0.0, 72: 0.26577393102698105, 73: 0.46393467213065576, 74: 0.3857298875594854, 75: 0.44742622132182486, 76: 0.41252718769935554, 77: 0.4814165330672351, 78: 0.6524910033712642, 79: 0.0, 80: 0.2604007218471553}}
/root/autodl-tmp/TokeContrast/./utils/evaluate.py:22: RuntimeWarning: invalid value encountered in true_divide
  _acc_cls = np.diag(hist) / hist.sum(axis=1)
/root/autodl-tmp/TokeContrast/./utils/evaluate.py:24: RuntimeWarning: invalid value encountered in true_divide
  iu = np.diag(hist) / (hist.sum(axis=1) + hist.sum(axis=0) - np.diag(hist))
{'pAcc': 0.7865774821018778, 'mAcc': 0.6327380132932562, 'miou': 0.42769556079250703, 'iou': {0: 0.7670694683044548, 1: 0.5174184364380203, 2: 0.3717415346670419, 3: 0.45381321838386135, 4: 0.6237495499131481, 5: 0.6969954048443329, 6: 0.6664261039917466, 7: 0.4912323103611855, 8: 0.488603952801233, 9: 0.4755025896662144, 10: 0.3390034737299175, 11: 0.7388560596727852, 12: 0.5817356226642109, 13: 0.6557188199078412, 14: 0.39808058887961967, 15: 0.5651145743230366, 16: 0.6956079862935897, 17: 0.5865879048738265, 18: 0.7235606429615197, 19: 0.7899298465889352, 20: 0.6565387846541585, 21: 0.8369177120591869, 22: 0.7117576299095776, 23: 0.7641554581740599, 24: 0.7224208817675668, 25: 0.1294041663051756, 26: 0.6496195063687064, 27: 0.034196515043201356, 28: 0.10794556968364313, 29: 0.5402957227074044, 30: 0.5644805623649776, 31: 0.028287956905927523, 32: 0.17896809311483003, 33: 0.09136488299540388, 34: 0.524010538584343, 35: 0.0075520972265830325, 36: 0.07590044214814447, 37: 0.14560677407073466, 38: 0.06239777906355993, 39: 0.04194377796199342, 40: 0.17815077485536243, 41: 0.22732824617117212, 42: 0.2546585097965113, 43: 0.007945607385860124, 44: 0.13393741196814815, 45: 0.03445980628226369, 46: 0.1862770670148264, 47: 0.687491464314004, 48: 0.45247294179087777, 49: 0.4582398117850672, 50: 0.7433985063403041, 51: 0.476701454046862, 52: 0.48921305778313856, 53: 0.5656917772616942, 54: 0.531928443366594, 55: 0.46264765516018336, 56: 0.30936963239531245, 57: 0.2553362720218165, 58: 0.392103026202949, 59: 0.1801346139247395, 60: 0.533582881421428, 61: 0.24239389407109846, 62: 0.5468706880015288, 63: 0.5119812743380956, 64: 0.577525561936543, 65: 0.1429958695925754, 66: 0.7501799096134102, 67: 0.5270891638373706, 68: 0.5511500129469779, 69: 0.5870585314186396, 70: 0.3383103586789329, 71: nan, 72: 0.17816194079017006, 73: 0.4964820107303941, 74: 0.24274581581652768, 75: 0.4429319692825737, 76: 0.41643363761837326, 77: 0.534338411679667, 78: 0.6218735071439946, 79: 0.0, 80: 0.4455404042388756}}
[Parallel(n_jobs=76)]: Done 492 out of 5000 | elapsed:  4.5min remaining: 41.2min
[Parallel(n_jobs=76)]: Done 993 out of 5000 | elapsed:  8.7min remaining: 35.1min
[Parallel(n_jobs=76)]: Done 1494 out of 5000 | elapsed: 13.3min remaining: 31.2min
[Parallel(n_jobs=76)]: Done 1995 out of 5000 | elapsed: 17.8min remaining: 26.8min
[Parallel(n_jobs=76)]: Done 2496 out of 5000 | elapsed: 22.2min remaining: 22.3min
[Parallel(n_jobs=76)]: Done 2997 out of 5000 | elapsed: 26.8min remaining: 17.9min
[Parallel(n_jobs=76)]: Done 3498 out of 5000 | elapsed: 31.3min remaining: 13.4min
[Parallel(n_jobs=76)]: Done 3999 out of 5000 | elapsed: 35.7min remaining:  8.9min
[Parallel(n_jobs=76)]: Done 4500 out of 5000 | elapsed: 39.9min remaining:  4.4min
[Parallel(n_jobs=76)]: Done 5000 out of 5000 | elapsed: 43.9min finished
{'pAcc': 0.7911180564807816, 'mAcc': 0.6178834908002147, 'miou': 0.4288030916697078, 'iou': {0: 0.7709250197316265, 1: 0.5246176311563595, 2: 0.4329559931082348, 3: 0.39312174456902854, 4: 0.619187170376781, 5: 0.7590528825463103, 6: 0.6717692126137241, 7: 0.4947186844376518, 8: 0.4581260666072065, 9: 0.4839870667902667, 10: 0.4544682197315476, 11: 0.6762445491234865, 12: 0.6808793228522138, 13: 0.6540513977670251, 14: 0.3943060830530546, 15: 0.6029032016885499, 16: 0.6964174846982646, 17: 0.6252001846565122, 18: 0.6954568287249661, 19: 0.7614575699682278, 20: 0.6730934053869093, 21: 0.8200969023710772, 22: 0.8093411649584632, 23: 0.7854409798670156, 24: 0.720101324654131, 25: 0.19318165606624618, 26: 0.650059626314396, 27: 0.0764889193483452, 28: 0.12148378584128908, 29: 0.5608762823751998, 30: 0.36346785983550234, 31: 0.019693249382005514, 32: 0.08915644207405421, 33: 0.10695550572450176, 34: 0.46800468624925123, 35: 0.006990547967183269, 36: 0.1441387436052548, 37: 0.11362079600499275, 38: 0.0896941869057608, 39: 0.03316652303710049, 40: 0.23014876647896493, 41: 0.20929998727014776, 42: 0.3115090856885024, 43: 0.07631748932444825, 44: 0.1391624780202073, 45: 0.036572038902181914, 46: 0.16092822278598917, 47: 0.7077106575738736, 48: 0.48947486220728426, 49: 0.44742727897662965, 50: 0.686524098202033, 51: 0.5303657559752049, 52: 0.5206689541016992, 53: 0.6357152236323954, 54: 0.6086199786562431, 55: 0.6450176140487529, 56: 0.4168933465121317, 57: 0.2296673915310392, 58: 0.40914906185539957, 59: 0.20437236000129635, 60: 0.5114557832581749, 61: 0.2312885912783047, 62: 0.6101080866270272, 63: 0.48508189160512144, 64: 0.5699342770452566, 65: 0.10539396092362345, 66: 0.5778853554015032, 67: 0.44209508515202833, 68: 0.5427927735954776, 69: 0.5181136778449114, 70: 0.3164997669270765, 71: 0.0, 72: 0.24511139244166097, 73: 0.5287626399514169, 74: 0.31894977127547147, 75: 0.50822154472496, 76: 0.37119803467962464, 77: 0.4858715767176061, 78: 0.6655223229675594, 79: 0.0, 80: 0.3083203389153885}}

